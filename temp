def _strip_trailing_fillers(name: str) -> str:
    FILLERS = {"VE","DE","DA","TE","TA","İLE","VEYA","VE.","DE.","DA.","TE.","TA.",
               "AN","TIC","TİC","SAN","VE.","TIC.","TİC.","SAN."}
    toks = [t for t in name.split() if t]
    while toks and (toks[-1].upper() in FILLERS or len(toks[-1]) < 3):
        toks.pop()
    return " ".join(toks)

# ... her seg/nm üretiminden sonra:
seg = _strip_trailing_fillers(seg)
# ve satır tabanlı nm için de:
nm  = _strip_trailing_fillers(nm)