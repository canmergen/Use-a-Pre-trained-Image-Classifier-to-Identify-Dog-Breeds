from typing import Any, List

def _get_text(x: Any) -> str:
    if isinstance(x, str):
        return x
    if isinstance(x, dict):
        for k in ("text", "extractedText", "extracted_text", "full_text"):
            v = x.get(k)
            if isinstance(v, str):
                return v
    return ""

def align_region_texts_to_page_texts(
    paddle_ocr_texts: Any,                 # str | dict | List[str|dict]
    paddle_ocr_regions: Any,               # List[dict] | List[List[dict]]
    inplace: bool = False
):
    """
    Sadece 'text' alanlarını değiştirir. Yapıyı aynen korur.
    Tek sayfa -> List[dict], Çok sayfa -> List[List[dict]] döner.
    """
    # regions yapısını tek/çok sayfa olarak ayır
    is_multi_page = len(paddle_ocr_regions) > 0 and isinstance(paddle_ocr_regions[0], list)
    pages = paddle_ocr_regions if is_multi_page else [paddle_ocr_regions]

    # texts’i listele (tek metin verildiyse tüm sayfalara uygula)
    if isinstance(paddle_ocr_texts, list):
        page_texts = paddle_ocr_texts
    else:
        page_texts = [paddle_ocr_texts] * len(pages)

    # çıkış yapısı (orijinali bozma)
    out_pages: List[List[dict]] = []
    for i, regions_on_page in enumerate(pages):
        page_text = _get_text(page_texts[i]) if i < len(page_texts) else ""
        page_out = regions_on_page if inplace else [dict(r) for r in regions_on_page]
        for r in page_out:
            r["text"] = page_text
        out_pages.append(page_out)

    return out_pages if is_multi_page else out_pages[0]

paddle_ocr_regions_aligned = align_region_texts_to_page_texts(
    paddle_ocr_texts,
    paddle_ocr_regions,
    inplace=False  # True yaparsan yerinde değiştirir
)